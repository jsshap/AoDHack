
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <body>
    <div class="container">
      <form id="newEventInfo" onsubmit="processNewEvent()" style="text-align: center; position: relative">

        <label for="fname">First Name</label>
        <input type="text" id="fname" name="firstname" placeholder="Your first name.." required>

        <label for="lname">Last Name</label>
        <input type="text" id="lname" name="lastname" placeholder="Your last name.." required>

        <label for="email">Email</label>
        <input type="text" id="email" name="email" placeholder="stevejobs@gmail.com" required>

        <label for="minpart">Minimum Participants</label>
        <input type="text" id="minipart" name="minipart" placeholder='0' required>

        
        <label for="maxpart">Maximum Participants</label>
        <input type="text" id="maxpart" name="maxpart" placeholder='100' required>


        <label for="ename">Event Name</label>
        <input type="text" id="ename" name="maxpart" placeholder='John Doe' required>

        <label for="etime">Event Time</label>
        <input type="text" id="etime" name="eventtime" placeholder="00:00:0000" required>

        <label for="elocation">Event Location</label>
        <input type="text" id="elocation" name="eventlocation" placeholder="Buckingham Palace" required>

        <label for="edesc">Event Description</label>
        <textarea id="edesc" name="edesc" placeholder="Write something.." style="height:200px" required></textarea>

        <input type="button" value="Submit" onclick="go()">

      </form>
    </div>
    <script> 
function createHangout(eventID, eventTitle, eventTime, eventLocation, eventMin, eventMax, eventDescription) {
  let config = {
    apiKey: "AIzaSyC8iaO8kb95S5mnUa2WLSCrCO-2Vq7RWiE",
    authDomain: "amherst-hangout.firebaseapp.com",
    projectId: "amherst-hangout",
    databaseURL: "https://amherst-hangout-default-rtdb.firebaseio.com/",
  };
  if (!firebase.apps.length) {
    firebase.initializeApp(config);
  }

  this.database = firebase.database();
  let userRef = this.database.ref('Events/');

  let emptylist = [];


  userRef.child(eventID).set({
    'EventID': eventID,
      'Time': eventTime,
      'Location': eventLocation,
      'Title' : eventTitle,
      'Description': eventDescription,
      'min': eventMin,
      'max': eventMax,
      'Participants' : emptylist
  });

  console.log('this method finished.')

}



</script>


    <script> 
function go2(eventID,name,email) {
  let config = {
    apiKey: "AIzaSyC8iaO8kb95S5mnUa2WLSCrCO-2Vq7RWiE",
    authDomain: "amherst-hangout.firebaseapp.com",
    projectId: "amherst-hangout",
    databaseURL: "https://amherst-hangout-default-rtdb.firebaseio.com/",
  };
  if (!firebase.apps.length) {
    firebase.initializeApp(config);
  }

  this.database = firebase.database();


  let userRef = this.database.ref('Events/' + eventID);

  // emptylist = [];
  // //Create participants list
  // userRef.child('Participants').set(emptylist)

  // Update (push participant to list)
  userRef.child('Participants').push({'Name': name, 'Email':email})

}

</script>

<script>

function getEvents() {
  let config = {
    apiKey: "AIzaSyC8iaO8kb95S5mnUa2WLSCrCO-2Vq7RWiE",
    authDomain: "amherst-hangout.firebaseapp.com",
    projectId: "amherst-hangout",
    databaseURL: "https://amherst-hangout-default-rtdb.firebaseio.com/",
  };
  if (!firebase.apps.length) {
    firebase.initializeApp(config);
  }

  this.database = firebase.database();

  let userRef = this.database.ref('Events/');

  userRef.on("value", function(snapshot) {
  console.log(snapshot.val()); }
  , function (errorObject) {
  console.log("The read failed: " + errorObject.code);
  });

  
}</script>
    <script>
      function addParticipant(eventID,name,email) {
        let config = {
          apiKey: "AIzaSyC8iaO8kb95S5mnUa2WLSCrCO-2Vq7RWiE",
          authDomain: "amherst-hangout.firebaseapp.com",
          projectId: "amherst-hangout",
          databaseURL: "https://amherst-hangout-default-rtdb.firebaseio.com/",
        };
        if (!firebase.apps.length) {
          firebase.initializeApp(config);
        }

        this.database = firebase.database();


        let userRef = this.database.ref('Events/' + eventID);

        // emptylist = [];
        // //Create participants list
        // userRef.child('Participants').set(emptylist)

        // Update (push participant to list)
        userRef.child('Participants').push({'Name': name, 'Email':email})

      }
    </script>
    <script>

    function go(){
      event.preventDefault();
      var fname=document.getElementById("fname").value.toString();
      var lname=document.getElementById("lname").value.toString();
      var email=document.getElementById("email").value.toString();
      var minipart=document.getElementById("minipart").value.toString();
      var maxpart=document.getElementById("maxpart").value.toString();
      var ename=document.getElementById("ename").value.toString();
      var etime=document.getElementById("etime").value.toString();
      var elocation=document.getElementById("elocation").value.toString();
      var edesc=document.getElementById("edesc").value.toString();
      document.getElementById("newEventInfo").reset();
      var numEvents = Math.round(Math.random()*4206969);//EDIT THIS SHIT LATER!!
      createHangout(numEvents, ename, etime, elocation, minipart, maxpart, edesc);
      console.log(numEvents);
      addParticipant(numEvents,fname+' '+lname,email);
    }
    //document.onclick=function(){}
  </script>
    <script src="https://www.gstatic.com/firebasejs/8.2.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.1/firebase-database.js"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <script src="script.js"></script>
    <script>


    //document.onclick=function(){}
  </script>
  </body>
</html>
